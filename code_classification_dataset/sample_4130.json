{
    "prob_desc_time_limit": "3 seconds",
    "prob_desc_sample_outputs": "[\"2\\n4\"]",
    "src_uid": "b9072c70548ee3295d832408f419ad2e",
    "prob_desc_notes": null,
    "prob_desc_description": "Little Fiona has a collection of $$$n$$$ blocks of various sizes $$$a_1, a_2, \\ldots, a_n$$$, where $$$n$$$ is even. Some of the blocks can be equal in size. She would like to put all these blocks one onto another to form a fancy stack.Let $$$b_1, b_2, \\ldots, b_n$$$ be the sizes of blocks in the stack from top to bottom. Since Fiona is using all her blocks, $$$b_1, b_2, \\ldots, b_n$$$ must be a permutation of $$$a_1, a_2, \\ldots, a_n$$$. Fiona thinks the stack is fancy if both of the following conditions are satisfied:   The second block is strictly bigger than the first one, and then each block is alternately strictly smaller or strictly bigger than the previous one. Formally, $$$b_1 &lt; b_2 &gt; b_3 &lt; b_4 &gt; \\ldots &gt; b_{n-1} &lt; b_n$$$.  The sizes of the blocks on even positions are strictly increasing. Formally, $$$b_2 &lt; b_4 &lt; b_6 &lt; \\ldots &lt; b_n$$$ (remember that $$$n$$$ is even).   Two stacks are considered different if their corresponding sequences $$$b_1, b_2, \\ldots, b_n$$$ differ in at least one position.Fiona wants to know how many different fancy stacks she can build with all of her blocks. Since large numbers scare Fiona, find this number modulo $$$998\\,244\\,353$$$.",
    "prob_desc_output_spec": "For each test case, print the number of ways to build a fancy stack, modulo $$$998\\,244\\,353$$$.",
    "prob_desc_input_spec": "Each input contains multiple test cases. The first line contains the number of test cases $$$t$$$ ($$$1 \\le t \\le 2500$$$). Description of the test cases follows. The first line of each test case contains a single integer $$$n$$$ — the number of blocks at Fiona's disposal ($$$2 \\le n \\le 5000$$$; $$$n$$$ is even). The second line contains $$$n$$$ integers $$$a_1, a_2, \\ldots, a_n$$$ — the sizes of the blocks in non-decreasing order ($$$1 \\le a_1 \\le a_2 \\le \\dotsb \\le a_n \\le n$$$). It is guaranteed that the sum of $$$n$$$ over all test cases does not exceed $$$5000$$$.",
    "prob_desc_output_to": "standard output",
    "prob_desc_input_from": "standard input",
    "lang": "PyPy 3",
    "lang_cluster": "Python",
    "difficulty": 2200,
    "file_name": "train_091.jsonl",
    "code_uid": "4993641acaf0484b118230c22d61976d",
    "prob_desc_memory_limit": "512 megabytes",
    "prob_desc_sample_inputs": "[\"2\\n\\n4\\n\\n1 2 3 4\\n\\n8\\n\\n1 1 2 3 4 4 6 7\"]",
    "exec_outcome": "PASSED",
    "source_code": "import os\r\nimport sys\r\nfrom io import BytesIO, IOBase\r\n\r\n_str = str\r\nstr = lambda x=b\"\": x if type(x) is bytes else _str(x).encode()\r\nBUFSIZE = 8192\r\n\r\nclass FastIO(IOBase):\r\n    newlines = 0\r\n\r\n    def __init__(self, file):\r\n        self._fd = file.fileno()\r\n        self.buffer = BytesIO()\r\n        self.writable = \"x\" in file.mode or \"r\" not in file.mode\r\n        self.write = self.buffer.write if self.writable else None\r\n\r\n    def read(self):\r\n        while True:\r\n            b = os.read(self._fd, max(os.fstat(self._fd).st_size, BUFSIZE))\r\n            if not b:\r\n                break\r\n            ptr = self.buffer.tell()\r\n            self.buffer.seek(0, 2), self.buffer.write(b), self.buffer.seek(ptr)\r\n        self.newlines = 0\r\n        return self.buffer.read()\r\n\r\n    def readline(self):\r\n        while self.newlines == 0:\r\n            b = os.read(self._fd, max(os.fstat(self._fd).st_size, BUFSIZE))\r\n            self.newlines = b.count(b\"\\n\") + (not b)\r\n            ptr = self.buffer.tell()\r\n            self.buffer.seek(0, 2), self.buffer.write(b), self.buffer.seek(ptr)\r\n        self.newlines -= 1\r\n        return self.buffer.readline()\r\n\r\n    def flush(self):\r\n        if self.writable:\r\n            os.write(self._fd, self.buffer.getvalue())\r\n            self.buffer.truncate(0), self.buffer.seek(0)\r\n\r\nclass IOWrapper(IOBase):\r\n    def __init__(self, file):\r\n        self.buffer = FastIO(file)\r\n        self.flush = self.buffer.flush\r\n        self.writable = self.buffer.writable\r\n        self.write = lambda s: self.buffer.write(s.encode(\"ascii\"))\r\n        self.read = lambda: self.buffer.read().decode(\"ascii\")\r\n        self.readline = lambda: self.buffer.readline().decode(\"ascii\")\r\n\r\nsys.stdin, sys.stdout = IOWrapper(sys.stdin), IOWrapper(sys.stdout)\r\ninput = lambda: sys.stdin.readline().rstrip(\"\\r\\n\")\r\n\r\nfrom collections import Counter\r\n\r\ndef main():\r\n    t = int(input())\r\n    while t:\r\n        n = int(input())\r\n        a = list(map(int, input().strip().split(' ')))\r\n        MOD = 998244353\r\n        fac = [1] * (n + 1)\r\n        inv = [1] * (n + 1)\r\n        finv = [1] * (n + 1)\r\n        for i in range(2, n + 1):\r\n            fac[i] = fac[i-1] * i % MOD\r\n            inv[i] = MOD - MOD // i * inv[MOD%i] % MOD\r\n            finv[i] = finv[i-1] * inv[i] % MOD\r\n        \r\n        def C(n, m):\r\n            if m == 0:\r\n                return 1\r\n            if m > n:\r\n                return 0\r\n            return fac[n] * finv[m] * finv[n-m] % MOD\r\n\r\n        cnt = Counter(a)\r\n        cnt = sorted(cnt.items(), key=lambda x: x[0], reverse=True)\r\n        dp = [[0] * (n//2+1) for _ in range(len(cnt)+1)]\r\n        dp[0][0] = 1\r\n        pre_sum = [0] * (len(cnt)+1)\r\n        for i in range(1, len(cnt)+1):\r\n            pre_sum[i] = pre_sum[i-1] + cnt[i-1][1]\r\n        for i in range(len(cnt)):\r\n            for j in range(min(i+1, n//2+1)):\r\n                small = pre_sum[i]-j\r\n                if j < n // 2:\r\n                    dp[i+1][j+1] = (dp[i+1][j+1] + dp[i][j] * C(j-1-small, cnt[i][1]-1)) % MOD\r\n                slot = j-1-small\r\n                if j == n // 2:\r\n                    slot += 1\r\n                dp[i+1][j] = (dp[i+1][j] + dp[i][j] * C(slot, cnt[i][1])) % MOD\r\n        print(dp[len(cnt)][n//2])\r\n        t -= 1\r\n    return\r\n\r\nmain()",
    "prob_desc_created_at": "1649837100",
    "tags": [
        "combinatorics",
        "dp",
        "implementation"
    ],
    "hidden_unit_tests": ""
}