{
    "prob_desc_time_limit": "3 seconds",
    "prob_desc_sample_outputs": "[\"1\\n1 1\\n0 0\\n1 0\\n2\\n0 1\\n1 1\\n2\\n3 2\\n0 4\\n1 5\\n1\\n8 42\\n2\\n5 7\\n3 1\\n4 3\\n0 0\\n4 1\"]",
    "src_uid": "fdbfe3108e701123693c6e0a6bf9a539",
    "prob_desc_notes": null,
    "prob_desc_description": "The chef has cooked $$$n$$$ dishes yet again: the $$$i$$$-th dish consists of $$$a_i$$$ grams of fish and $$$b_i$$$ grams of meat. Banquet organizers consider two dishes $$$i$$$ and $$$j$$$ equal if $$$a_i=a_j$$$ and $$$b_i=b_j$$$ at the same time.The banquet organizers estimate the variety of $$$n$$$ dishes as follows. The variety of a set of dishes is equal to the number of different dishes in it. The less variety is, the better.In order to reduce the variety, a taster was invited. He will eat exactly $$$m_i$$$ grams of food from each dish. For each dish, the taster determines separately how much fish and how much meat he will eat. The only condition is that he will eat exactly $$$m_i$$$ grams of the $$$i$$$-th dish in total.Determine how much of what type of food the taster should eat from each dish so that the value of variety is the minimum possible. If there are several correct answers, you may output any of them.",
    "prob_desc_output_spec": "For each test case, print on the first line the minimum value of variety that can be achieved by eating exactly $$$m_i$$$ grams of food (for all $$$i$$$ from $$$1$$$ to $$$n$$$) from a dish $$$i$$$. Then print $$$n$$$ lines that describe a way to do this: the $$$i$$$-th line should contain two integers $$$x_i$$$ and $$$y_i$$$ ($$$0 \\leq x_i \\leq a_i$$$; $$$0 \\leq y_i \\leq b_i$$$; $$$x_i+y_i=m_i$$$), where $$$x_i$$$ is how many grams of fish the taster should eat from $$$i$$$-th dish, and $$$y_i$$$ is how many grams of meat. If there are several ways to achieve a minimum balance, print any of them.",
    "prob_desc_input_spec": "The first line of input data contains an integer $$$t$$$ ($$$1 \\leq t \\leq 10^4$$$) — the number of test cases. Each test case's description is preceded by a blank line. Next comes a line that contains an integer $$$n$$$ ($$$1 \\leq n \\leq 2 \\cdot 10^5$$$) — the number of dishes. Then follows $$$n$$$ lines, $$$i$$$-th of which contains three integers $$$a_i$$$, $$$b_i$$$ and $$$m_i$$$ ($$$0 \\leq a_i, b_i \\le 10^6$$$; $$$0 \\le m_i \\le a_i+b_i$$$) — the mass of fish in $$$i$$$-th dish, the mass of meat in $$$i$$$-th dish and how many grams in total the taster should eat in $$$i$$$-th dish. The sum of all $$$n$$$ values for all input data sets in the test does not exceed $$$2 \\cdot 10^5$$$.",
    "prob_desc_output_to": "standard output",
    "prob_desc_input_from": "standard input",
    "lang": "PyPy 3-64",
    "lang_cluster": "Python",
    "difficulty": 2200,
    "file_name": "train_108.jsonl",
    "code_uid": "f9b0b60de34e120b6a5d9c41582e5c1a",
    "prob_desc_memory_limit": "256 megabytes",
    "prob_desc_sample_inputs": "[\"5\\n\\n3\\n10 10 2\\n9 9 0\\n10 9 1\\n\\n2\\n3 4 1\\n5 1 2\\n\\n3\\n7 2 5\\n6 5 4\\n5 5 6\\n\\n1\\n13 42 50\\n\\n5\\n5 7 12\\n3 1 4\\n7 3 7\\n0 0 0\\n4 1 5\"]",
    "exec_outcome": "PASSED",
    "source_code": "from __future__ import division, print_function\r\npy2 = round(0.5)\r\n\r\nif py2:\r\n    from future_builtins import ascii, filter, hex, map, oct, zip\r\n    range = xrange\r\n\r\nimport os, sys\r\nfrom io import BytesIO, IOBase\r\n\r\n# FastIO for PyPy2 and PyPy3 (works with interactive) by Pajenegod\r\nclass FastI(object):\r\n    def __init__(self, fd=0, buffersize=2**14):\r\n        self.stream = stream = BytesIO(); self.bufendl = 0\r\n        def read2buffer():\r\n            s = os.read(fd, buffersize + os.fstat(fd).st_size); pos = stream.tell()\r\n            stream.seek(0,2); stream.write(s); stream.seek(pos); return s\r\n        self.read2buffer = read2buffer\r\n    # Read entire input\r\n    def read(self):\r\n        while self.read2buffer(): pass\r\n        return self.stream.read() if self.stream.tell() else self.stream.getvalue()\r\n    def readline(self):\r\n        while self.bufendl == 0: s = self.read2buffer(); self.bufendl += s.count(b'\\n') + (not s)\r\n        self.bufendl -= 1; return self.stream.readline()\r\n    def input(self): return self.readline().rstrip(b'\\r\\n')\r\n\r\n    # Read all remaining integers, type is given by optional argument\r\n    def readnumbers(self, zero=0):\r\n        conv = ord if py2 else lambda x:x\r\n        A = []; numb = zero; sign = 1; c = b'-'[0]\r\n        for c in self.read():\r\n            if c >= b'0'[0]: numb = 10 * numb + conv(c) - 48\r\n            elif c == b'-'[0]: sign = -1\r\n            elif c != b'\\r'[0]: A.append(sign*numb); numb = zero; sign = 1\r\n        if c >= b'0'[0]: A.append(sign*numb)\r\n        return A\r\n\r\nclass FastO(IOBase):\r\n    def __init__(self, fd=1):\r\n        stream = BytesIO()\r\n        self.flush = lambda: os.write(1, stream.getvalue()) and not stream.truncate(0) and stream.seek(0)\r\n        self.write = stream.write if py2 else lambda s: stream.write(s.encode())\r\n\r\nsys.stdin, sys.stdout = FastI(), FastO()\r\ninput = sys.stdin.readline\r\n\r\n# ======================== end of fast io ========================\r\n\r\nimport collections\r\n\r\ndef solve(As, Bs, Ms):\r\n    # collect dishes with same (a + b - m) as groups\r\n    groups = collections.defaultdict(list)\r\n    for i, (a, b, m) in enumerate(zip(As, Bs, Ms)):\r\n        groups[a + b - m].append((a + min(b - m, 0), max(a - m, 0), i))\r\n\r\n    var = 0\r\n    ans = [None for _ in range(len(As))]\r\n    for (_, group) in groups.items():\r\n        group.sort()  # sort (max_a, min_a, i)\r\n        prev_a = -1\r\n        for (max_a, min_a, idx) in group:\r\n            if min_a <= prev_a:\r\n                ans[idx] = [(As[idx] - prev_a), (Ms[idx] - (As[idx] - prev_a))]\r\n            else:\r\n                ans[idx] = [(As[idx] - max_a), (Ms[idx] - (As[idx] - max_a))]\r\n                prev_a = max_a\r\n                var += 1\r\n    print(var)\r\n    for a in ans:\r\n        print(*a)\r\n\r\ndef main():\r\n    Q = int(input())\r\n    for _ in range(Q):\r\n        input()\r\n        n = int(input())\r\n        As, Bs, Ms = [], [], []\r\n        for _ in range(n):\r\n            a, b, m = map(int, input().split())\r\n            As.append(a); Bs.append(b); Ms.append(m)\r\n        solve(As, Bs, Ms)\r\n\r\nif __name__ == \"__main__\":\r\n    main()",
    "prob_desc_created_at": "1635863700",
    "tags": [
        "greedy",
        "sortings",
        "two pointers"
    ],
    "hidden_unit_tests": ""
}