{
    "prob_desc_time_limit": "2 seconds",
    "prob_desc_sample_outputs": "[\"5\\n1 2\\n5 3\\n4 5\\n1 5\\n1 3\", \"0\"]",
    "src_uid": "3b885c926076382f778a27a3c1f49d91",
    "prob_desc_notes": "NoteThe following animation showcases the first sample test case. The black numbers represent the indices of the points, while the boxed orange numbers represent their labels.  In the second test case, all labels are already in their correct positions, so no operations are necessary.",
    "prob_desc_description": "Based on a peculiar incident at basketball practice, Akari came up with the following competitive programming problem!You are given $$$n$$$ points on the plane, no three of which are collinear. The $$$i$$$-th point initially has a label $$$a_i$$$, in such a way that the labels $$$a_1, a_2, \\dots, a_n$$$ form a permutation of $$$1, 2, \\dots, n$$$.You are allowed to modify the labels through the following operation:  Choose two distinct integers $$$i$$$ and $$$j$$$ between $$$1$$$ and $$$n$$$.  Swap the labels of points $$$i$$$ and $$$j$$$, and finally  Draw the segment between points $$$i$$$ and $$$j$$$. A sequence of operations is valid if after applying all of the operations in the sequence in order, the $$$k$$$-th point ends up having the label $$$k$$$ for all $$$k$$$ between $$$1$$$ and $$$n$$$ inclusive, and the drawn segments don't intersect each other internally. Formally, if two of the segments intersect, then they must do so at a common endpoint of both segments.In particular, all drawn segments must be distinct.Find any valid sequence of operations, or say that none exist. ",
    "prob_desc_output_spec": "If it is impossible to perform a valid sequence of operations, print $$$-1$$$. Otherwise, print an integer $$$k$$$ ($$$0 \\le k \\le \\frac{n(n - 1)}{2}$$$)  — the number of operations to perform, followed by $$$k$$$ lines, each containing two integers $$$i$$$ and $$$j$$$ ($$$1 \\le i, j \\le n$$$, $$$i\\neq j$$$)  — the indices of the points chosen for the operation. Note that you are not required to minimize or maximize the value of $$$k$$$. If there are multiple possible answers, you may print any of them.",
    "prob_desc_input_spec": "The first line contains an integer $$$n$$$ ($$$3 \\le n \\le 2000$$$)  — the number of points. The $$$i$$$-th of the following $$$n$$$ lines contains three integers $$$x_i$$$, $$$y_i$$$, $$$a_i$$$ ($$$-10^6 \\le x_i, y_i \\le 10^6$$$, $$$1 \\le a_i \\le n$$$), representing that the $$$i$$$-th point has coordinates $$$(x_i, y_i)$$$ and initially has label $$$a_i$$$. It is guaranteed that all points are distinct, no three points are collinear, and the labels $$$a_1, a_2, \\dots, a_n$$$ form a permutation of $$$1, 2, \\dots, n$$$.",
    "prob_desc_output_to": "standard output",
    "prob_desc_input_from": "standard input",
    "lang": "Python 3",
    "lang_cluster": "Python",
    "difficulty": 3000,
    "file_name": "train_087.jsonl",
    "code_uid": "769343769fd52101ba06f019dab19e35",
    "prob_desc_memory_limit": "256 megabytes",
    "prob_desc_sample_inputs": "[\"5\\n-1 -2 2\\n3 0 5\\n1 3 4\\n4 -3 3\\n5 2 1\", \"3\\n5 4 1\\n0 0 2\\n-3 -2 3\"]",
    "exec_outcome": "PASSED",
    "source_code": "import sys,io,os\r\ntry:Z=io.BytesIO(os.read(0,os.fstat(0).st_size)).readline\r\nexcept:Z=lambda:sys.stdin.readline().encode()\r\nfrom math import atan2;from collections import deque\r\ndef path(R):\r\n    H=deque();H.append(R)\r\n    while P[R]>=0:\r\n        R=P[R];H.append(R)\r\n        if len(H)>2:P[H.popleft()]=H[-1]\r\n    return R\r\ndef remove_middle(a,b,c):\r\n    cross=(a[0]-b[0])*(c[1]-b[1])-(a[1]-b[1])*(c[0]-b[0])\r\n    dot=(a[0]-b[0])*(c[0]-b[0])+(a[1]-b[1])*(c[1]-b[1])\r\n    return cross<0 or cross==0 and dot<=0\r\ndef convex_hull(points):\r\n    spoints=sorted(points);hull=[]\r\n    for p in spoints+spoints[::-1]:\r\n        while len(hull)>=2 and remove_middle(hull[-2],hull[-1],p):hull.pop()\r\n        hull.append(p)\r\n    hull.pop();return hull\r\nn=int(Z());p=[];p2=[];w=[-1]*n;labels=set()\r\nfor i in range(n):\r\n    x,y,a=map(int,Z().split());a-=1\r\n    if a!=i:p.append((x,y,i));p2.append((x,y));w[i]=a;labels.add(a)\r\nif not p:print(0);quit()\r\nq=[];bx,by,bi=p[-1];L=len(p)-1\r\nfor i in range(L):x,y,l=p[i];q.append((atan2(y-by,x-bx),(x,y),l))\r\nq.sort();cycles=[-1]*n;c=0\r\nwhile labels:\r\n    v=labels.pop();cycles[v]=c;cur=w[v]\r\n    while cur!=v:labels.remove(cur);cycles[cur]=c;cur=w[cur]\r\n    c+=1\r\nK=[-1]*c;P=[-1]*c;S=[1]*c;R=0;moves=[];ch=convex_hull(p2);adj1=adj2=None\r\nfor i in range(len(ch)):\r\n    x,y=ch[i]\r\n    if x==bx and y==by:adj1=ch[(i+1)%len(ch)];adj2=ch[i-1];break\r\nfor i in range(L):\r\n    if (q[i][1]==adj1 and q[i-1][1]==adj2)or(q[i][1]==adj2 and q[i-1][1]==adj1):continue\r\n    l1,l2=q[i][2],q[i-1][2];a,b=cycles[l1],cycles[l2]\r\n    if a!=b:\r\n        if K[a]>=0:\r\n            if K[b]>=0:\r\n                va,vb=path(K[a]),path(K[b])\r\n                if va!=vb:\r\n                    moves.append((l1,l2));sa,sb=S[va],S[vb]\r\n                    if sa>sb:P[vb]=va\r\n                    else:\r\n                        P[va]=vb\r\n                        if sa==sb:S[vb]+=1\r\n                else:pass\r\n            else:K[b]=path(K[a]);moves.append((l1,l2))\r\n        else:\r\n            moves.append((l1,l2))\r\n            if K[b]>=0:K[a]=path(K[b])\r\n            else:K[a]=R;K[b]=R;R+=1\r\nfor a,b in moves:w[a],w[b]=w[b],w[a]\r\nwhile w[bi]!=bi:a=w[bi];b=w[a];moves.append((a,bi));w[bi],w[a]=b,a\r\nprint(len(moves));print('\\n'.join(f'{a+1} {b+1}'for a,b in moves))",
    "prob_desc_created_at": "1618583700",
    "tags": [
        "constructive algorithms",
        "geometry",
        "sortings"
    ],
    "hidden_unit_tests": ""
}