{
    "prob_desc_time_limit": "3 seconds",
    "prob_desc_sample_outputs": "[\"2\\n4\\n-1\\n2\\n5\"]",
    "src_uid": "a18692e5fe2f98717608449b1d9b77f7",
    "prob_desc_notes": "NoteIn the first test case, imposters can be Andreas $$$2$$$ and $$$3$$$.In the second test case, imposters can be Andreas $$$1$$$, $$$2$$$, $$$3$$$ and $$$5$$$.In the third test case, comments contradict each other. This is because player $$$1$$$ says that player $$$2$$$ is an imposter, and player $$$2$$$ says that player $$$1$$$ is a crewmate. If player $$$1$$$ is a crewmate, then he must be telling the truth, so player $$$2$$$ must be an imposter. But if player $$$2$$$ is an imposter then he must be lying, so player $$$1$$$ can't be a crewmate. Contradiction.",
    "prob_desc_description": "Theofanis started playing the new online game called \"Among them\". However, he always plays with Cypriot players, and they all have the same name: \"Andreas\" (the most common name in Cyprus).In each game, Theofanis plays with $$$n$$$ other players. Since they all have the same name, they are numbered from $$$1$$$ to $$$n$$$.The players write $$$m$$$ comments in the chat. A comment has the structure of \"$$$i$$$ $$$j$$$ $$$c$$$\" where $$$i$$$ and $$$j$$$ are two distinct integers and $$$c$$$ is a string ($$$1 \\le i, j \\le n$$$; $$$i \\neq j$$$; $$$c$$$ is either imposter or crewmate). The comment means that player $$$i$$$ said that player $$$j$$$ has the role $$$c$$$.An imposter always lies, and a crewmate always tells the truth. Help Theofanis find the maximum possible number of imposters among all the other Cypriot players, or determine that the comments contradict each other (see the notes for further explanation).Note that each player has exactly one role: either imposter or crewmate.",
    "prob_desc_output_spec": "For each test case, print one integer — the maximum possible number of imposters. If the comments contradict each other, print $$$-1$$$.",
    "prob_desc_input_spec": "The first line contains a single integer $$$t$$$ ($$$1 \\le t \\le 10^4$$$) — the number of test cases. Description of each test case follows. The first line of each test case contains two integers $$$n$$$ and $$$m$$$ ($$$1 \\le n \\le 2 \\cdot 10^5$$$; $$$0 \\le m \\le 5 \\cdot 10^5$$$) — the number of players except Theofanis and the number of comments. Each of the next $$$m$$$ lines contains a comment made by the players of the structure \"$$$i$$$ $$$j$$$ $$$c$$$\" where $$$i$$$ and $$$j$$$ are two distinct integers and $$$c$$$ is a string ($$$1 \\le i, j \\le n$$$; $$$i \\neq j$$$; $$$c$$$ is either imposter or crewmate). There can be multiple comments for the same pair of $$$(i, j)$$$. It is guaranteed that the sum of all $$$n$$$ does not exceed $$$2 \\cdot 10^5$$$ and the sum of all $$$m$$$ does not exceed $$$5 \\cdot 10^5$$$.",
    "prob_desc_output_to": "standard output",
    "prob_desc_input_from": "standard input",
    "lang": "PyPy 3-64",
    "lang_cluster": "Python",
    "difficulty": 1700,
    "file_name": "train_097.jsonl",
    "code_uid": "8d4a1e1247a28467583c4fa499de6e4c",
    "prob_desc_memory_limit": "256 megabytes",
    "prob_desc_sample_inputs": "[\"5\\n3 2\\n1 2 imposter\\n2 3 crewmate\\n5 4\\n1 3 crewmate\\n2 5 crewmate\\n2 4 imposter\\n3 4 imposter\\n2 2\\n1 2 imposter\\n2 1 crewmate\\n3 5\\n1 2 imposter\\n1 2 imposter\\n3 2 crewmate\\n3 2 crewmate\\n1 3 imposter\\n5 0\"]",
    "exec_outcome": "PASSED",
    "source_code": "from collections import defaultdict\nfrom collections import deque\nfrom functools import lru_cache\nimport heapq\nfrom locale import resetlocale\nimport sys \nimport random\nimport math\ndef inp():\n    return(int(input()))\ndef inlt():\n    return(list(map(int,input().split())))\ndef insr():\n    s = input()\n    return(s)\ndef invr():\n    return(map(int,input().split()))\nz = inp()\n\nfor q in range(1, z+1):\n    \n    [players, comments] = inlt()\n\n    graph = defaultdict(list)\n\n    fakeNode = players + 1\n\n    for _ in range(comments):\n        s = sys.stdin.readline()\n        s = s.split(\" \")\n        a = int(s[0])\n        b = int(s[1])\n        c = s[2]\n        # print(\"line\", a,b,c)\n        if(\"imposter\" in c):\n            graph[a].append(b)\n            graph[b].append(a)\n        else:\n            graph[a].append(fakeNode)\n            graph[fakeNode].append(b)\n            graph[b].append(fakeNode)\n            graph[fakeNode].append(a)\n            fakeNode += 1\n\n    colors = [0] * (fakeNode+1)\n    ok = True\n    # print(graph)\n    def validColors(color, node):\n        if(colors[node] != 0):\n            return colors[node] == color \n        \n        colors[node] = color\n        for neighbour in graph[node]:\n            if(not validColors(-color, neighbour)):\n                return False \n        return True\n\n    for i in range(1,players+1):\n        if(colors[i] != 0):\n            continue \n        level = deque([i])\n        colors[i] = 1 \n\n        while(level):\n            length = len(level)\n            for _ in range(length):\n                node = level.popleft()\n                for neighbour in graph[node]:\n                    # print(colors, node, neighbour)\n                    if(colors[neighbour] == 0):\n                        colors[neighbour] = -colors[node]\n                        level.append(neighbour)\n                    elif(colors[neighbour] != -colors[node]):\n                            # print(\"not ok\")\n                            ok = False\n                            break \n        if(not ok):\n            break\n\n    if(not ok):\n        print(-1)\n        continue \n    cnt = defaultdict(int)\n    # print(colors)\n    visited = set()\n    res = 0\n    for i in range(1, players+1):\n        if(i in visited):\n            continue \n        component = set()\n        level = set([i])\n        while(level):\n            newLevel = set()\n            for node in level:\n                if(node in visited):\n                    continue \n                visited.add(node)\n                component.add(node)\n                for neighbour in graph[node]:\n                    newLevel.add(neighbour)\n            level = newLevel \n        cnt = defaultdict(int)\n        for idx in component:\n            if(idx > players ):\n                continue \n            cnt[colors[idx]] += 1\n        res += max(cnt[-1], cnt[1])\n\n    # print(\"ans\",res)\n    print(res)\n    \n\n",
    "prob_desc_created_at": "1633705500",
    "tags": [
        "constructive algorithms",
        "dfs and similar",
        "dp",
        "dsu",
        "graphs"
    ],
    "hidden_unit_tests": ""
}